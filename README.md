# 📊 엑셀 명세서 분석기

PySide6 + pandas + matplotlib 기반 GUI 프로그램으로, 카드/은행사에서 받은 엑셀 명세서를 불러와
가맹점 키워드 검색, 카테고리별 지출 분석, 월별 지출 차트 등을 제공합니다.
결과는 화면에 표시되며 동시에 CSV 파일로 저장됩니다.

---

## ✨ 기능
- **엑셀 파일 불러오기** (.xlsx, .xls)
- **가맹점 키워드 검색** (여러 개 동시 검색 가능)
- **검색 결과 합산**: 이용금액 자동 계산
- **카테고리 분류**: 카페/교통/오락/쇼핑 등 자동 분류
- **차트 시각화**
  - 카테고리별 지출 차트
  - 월별 지출 차트
- **최근 파일 관리**: 최근 파일 자동 저장 & 빠른 열기
- **로그 기록** (app.log)
- **결과 저장**: CSV 파일로 내보내기

---

## 🖥️ 실행 화면
- 상단: 최근 파일 열기, 엑셀 불러오기 버튼
- 중앙: 검색 키워드 입력, 빠른 키워드(체크박스) 선택
- 하단: 합계 결과, 검색 결과 테이블
- 추가 버튼:
  - 카테고리 요약 저장
  - 카테고리 차트 보기
  - 월별 지출 차트 보기

---

## ⚙️ 설정 (config.json)

config.json 파일에서 컬럼명, 카테고리 규칙 등을 쉽게 수정할 수 있습니다.
```json
{
  "APP_TITLE": "엑셀 명세서 금액 합산기",
  "LOG_PATH": "expense_sum.log",
  "RECENTS_PATH": "recent_files.json",

  "COL_STORE": "이용하신 가맹점",
  "COL_AMOUNT": "이용금액",
  "COL_DT": "DT",

  "DATE_COL_KEYS": ["일자", "승인일", "거래일", "사용일", "매출일", "결제일", "작성일"],

  "CATEGORY_MAP": {
    "오락": ["노래방", "노래연습", "코인노래", "PC방", "스크린", "볼링", "당구", "탁구"],
    "식비": ["카페", "커피", "스타벅스", "이디야", "투썸", "빽다방", "버거", "치킨", "KFC", "맥도날드", "피자", "이마트24", "GS25", "CU", "편의점"],
    "교통": ["주유소", "주유", "택시", "버스", "지하철", "고속도로", "하이패스", "SRT", "KTX", "ITX", "항공"],
    "쇼핑": ["마트", "백화점", "쿠팡", "G마켓", "11번가", "무신사"],
    "기타": []
  }
}
```

---

## 🚀 설치 및 실행 방법

### 1. 저장소 클론
```bash
1. 레포지토리 복사
git clone https://github.com/Hyunseung-Nam/excel_statement_analyzer.git
cd excel_statement_analyzer

2. 가상환경 설정(선택사항이지만 권장)
python -m venv .venv
source .venv/bin/activate    # Mac/Linux
.venv/Scripts/activate       # Windows

3. 라이브러리 설치
pip install -r requirements.txt

4. 실행
python src/main.py
```

---

## 📝 로그(logging)

- 실행 로그가 **`app.log`** 파일에 저장됩니다.    
- 로그에 기록되는 내용:  
  - 불러온 파일 경로
  - 입력한 키워드 및 매칭 결과  
  - 합산 금액  
  - 오류 메시지

---

## 💾 CSV 저장
- 검색 결과: 키워드_내역_YYYYMMDD_HHMM.csv
- 카테고리 요약: 카테고리_요약_YYYYMMDD_HHMM.csv
- Excel 호환을 위해 utf-8-sig 인코딩 적용

---

## 앞으로의 계획
- 그래프 가독성 높이기
- 예산 비율 자동 추천 기능 추가
